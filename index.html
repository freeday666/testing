<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8" />
<title>First Person Google Maps Race</title>
<style>
  body { margin:0; overflow:hidden; font-family:sans-serif; }
  #ui {
    position: absolute; top:10px; left:10px;
    background: rgba(0,0,0,0.3);
    padding: 10px;
    border-radius: 8px;
    color: white;
    z-index: 3;
  }
  #streetview {
    width: 100vw; height: 100vh;
  }
</style>
</head>
<body>

<div id="ui">
  <div>Locatie: <span id="location">Amsterdam</span></div>
  <div>Job: <span id="job">Rijder</span></div>
  <div>Snelheid: <span id="speed">0</span> km/u</div>
  <div>RPM: <span id="rpm">0</span></div>
  <div>Tijd: <span id="time">0.0</span> s</div>
  <div>Missies voltooid: <span id="missions">0</span>/5</div>
  <div>Actieve missie: <span id="currentMission">Geen</span></div>
</div>

<div id="streetview"></div>

<script>
  let panorama;
  let speed = 0; // km/u
  let rpm = 0;
  let timeElapsed = 0;
  let missionsCompleted = 0;
  let currentMission = "Geen";

  // Initial positie (Amsterdam)
  const initPosition = { lat: 52.370216, lng: 4.895168 };

  function init() {
    panorama = new google.maps.StreetViewPanorama(
      document.getElementById('streetview'),
      {
        position: initPosition,
        pov: { heading: 0, pitch: 0 },
        zoom: 1,
        disableDefaultUI: true,
      }
    );

    // Update tijd elke seconde
    setInterval(() => {
      timeElapsed += 1;
      document.getElementById('time').textContent = timeElapsed.toFixed(1);
    }, 1000);

    // Event listener voor toetsenbord
    document.addEventListener('keydown', handleKeyDown);
  }

  function handleKeyDown(e) {
    const stepSize = 5; // graden
    const moveDistance = 10; // meters per knopdruk

    switch(e.key) {
      case 'ArrowLeft':
        panorama.setPov({ heading: panorama.getPov().heading - stepSize, pitch: panorama.getPov().pitch });
        break;
      case 'ArrowRight':
        panorama.setPov({ heading: panorama.getPov().heading + stepSize, pitch: panorama.getPov().pitch });
        break;
      case 'ArrowUp':
        moveForward(moveDistance);
        break;
      case 'ArrowDown':
        moveForward(-moveDistance);
        break;
    }
  }

  function moveForward(distanceMeters) {
    const pos = panorama.getPosition();
    const heading = panorama.getPov().heading;

    const rad = heading * Math.PI / 180;
    const newLat = pos.lat() + (distanceMeters * Math.cos(rad)) / 111111; // ongeveer
    const newLng = pos.lng() + (distanceMeters * Math.sin(rad)) / (111111 * Math.cos(pos.lat() * Math.PI / 180));

    panorama.setPosition({ lat: newLat, lng: newLng });
  }

  // Simuleer snelheid en RPM
  setInterval(() => {
    document.getElementById('speed').textContent = speed.toFixed(1);
    document.getElementById('rpm').textContent = rpm.toFixed(0);
  }, 500);

  // Initializeer de Street View
  window.onload = init;
</script>
<!-- Google Maps API met jouw API-sleutel -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDFQMJ_GpXO_gCoTCqIy0yn8OKRFlRnD0A&callback=init"
async defer></script>
</body>
</html>
